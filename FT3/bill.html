<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Item-Based Bill Splitter</title>
    <link rel="stylesheet" href="bill.css">
    
    <script>
        const form = document.getElementById('bill-form');
        const tableBody = document.getElementById('consumption-table-body');
        const resultsDiv = document.getElementById('results');

        form.addEventListener('submit', (e) => {
            e.preventDefault();
            const totalBill = document.getElementById('total-bill').value;
            const numPeople = document.getElementById('people').value;
            const consumptionRows = tableBody.rows;

            let totalConsumption = 0;
            let consumptionArray = [];

            // calculate total consumption and store individual consumptions
            for (let i = 0; i < consumptionRows.length; i++) {
                const consumptionAmount = consumptionRows[i].cells[1].getElementsByTagName('input')[0].value;
                totalConsumption += parseFloat(consumptionAmount);
                consumptionArray.push(parseFloat(consumptionAmount));
            }

            // calculate each person's share
            const share = totalBill / totalConsumption;
            let resultsHTML = '';

            for (let i = 0; i < consumptionRows.length; i++) {
                const personName = consumptionRows[i].cells[0].getElementsByTagName('input')[0].value;
                const personShare = consumptionArray[i] * share;
                resultsHTML += <p>${personName} should pay $${personShare.toFixed(2)}</p>;
            }

            resultsDiv.innerHTML = resultsHTML;
            resultsDiv.style.opacity = 0; // set opacity to 0 before animation
            setTimeout(() => {
                resultsDiv.style.opacity = 1; // animate opacity to 1
            }, 100);
        });

        // dynamically generate table rows based on number of people
        document.getElementById('people').addEventListener('input', () => {
            const numPeople = document.getElementById('people').value;
            tableBody.innerHTML = '';

            for (let i = 0; i < numPeople; i++) {
                const row = tableBody.insertRow();
                row.innerHTML = `
                    <td><input type="text" placeholder="Name" required></td>
                    <td><input type="number" placeholder="Consumption Amount" required></td>
                `;
            }
        });
    </script>
</head>
<body>
    <div class="container">
        <h1>Item-Based Bill Splitter</h1>
        <div id="inputs">
            <div class="input-group">
                <input type="text" placeholder="Name" class="name">
                <input type="number" placeholder="Item Count" class="item-count" min="0">
                <input type="number" placeholder="Total Amount" class="total-amount" min="0" step="0.01">
                <button class="remove">Remove</button>
            </div>
        </div>
        <button id="add">Add Person</button>
        <button id="calculate">Calculate</button>
        <h2>Results</h2>
        <div id="results"></div>
    </div>
</body>
</html>